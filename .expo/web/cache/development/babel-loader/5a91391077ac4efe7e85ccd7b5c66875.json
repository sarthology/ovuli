{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nvar _jsxFileName = \"/home/harshit/Desktop/projects/ovuli/node_modules/react-native-calendars/src/agenda/reservation-list/index.js\";\nimport React, { Component } from 'react';\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Reservation from \"./reservation\";\nimport PropTypes from 'prop-types';\nimport XDate from 'xdate';\nimport dateutils from \"../../dateutils\";\nimport styleConstructor from \"./style\";\n\nvar ReservationList = function (_Component) {\n  _inherits(ReservationList, _Component);\n\n  function ReservationList(props) {\n    var _this;\n\n    _classCallCheck(this, ReservationList);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ReservationList).call(this, props));\n    _this.styles = styleConstructor(props.theme);\n    _this.state = {\n      reservations: []\n    };\n    _this.heights = [];\n    _this.selectedDay = _this.props.selectedDay;\n    _this.scrollOver = true;\n    return _this;\n  }\n\n  _createClass(ReservationList, [{\n    key: \"UNSAFE_componentWillMount\",\n    value: function UNSAFE_componentWillMount() {\n      this.updateDataSource(this.getReservations(this.props).reservations);\n    }\n  }, {\n    key: \"updateDataSource\",\n    value: function updateDataSource(reservations) {\n      this.setState({\n        reservations: reservations\n      });\n    }\n  }, {\n    key: \"updateReservations\",\n    value: function updateReservations(props) {\n      var reservations = this.getReservations(props);\n\n      if (this.list && !dateutils.sameDate(props.selectedDay, this.selectedDay)) {\n        var scrollPosition = 0;\n\n        for (var i = 0; i < reservations.scrollPosition; i++) {\n          scrollPosition += this.heights[i] || 0;\n        }\n\n        this.scrollOver = false;\n        this.list.scrollToOffset({\n          offset: scrollPosition,\n          animated: true\n        });\n      }\n\n      this.selectedDay = props.selectedDay;\n      this.updateDataSource(reservations.reservations);\n    }\n  }, {\n    key: \"UNSAFE_componentWillReceiveProps\",\n    value: function UNSAFE_componentWillReceiveProps(props) {\n      var _this2 = this;\n\n      if (!dateutils.sameDate(props.topDay, this.props.topDay)) {\n        this.setState({\n          reservations: []\n        }, function () {\n          _this2.updateReservations(props);\n        });\n      } else {\n        this.updateReservations(props);\n      }\n    }\n  }, {\n    key: \"onScroll\",\n    value: function onScroll(event) {\n      var yOffset = event.nativeEvent.contentOffset.y;\n      this.props.onScroll(yOffset);\n      var topRowOffset = 0;\n      var topRow;\n\n      for (topRow = 0; topRow < this.heights.length; topRow++) {\n        if (topRowOffset + this.heights[topRow] / 2 >= yOffset) {\n          break;\n        }\n\n        topRowOffset += this.heights[topRow];\n      }\n\n      var row = this.state.reservations[topRow];\n      if (!row) return;\n      var day = row.day;\n      var sameDate = dateutils.sameDate(day, this.selectedDay);\n\n      if (!sameDate && this.scrollOver) {\n        this.selectedDay = day.clone();\n        this.props.onDayChange(day.clone());\n      }\n    }\n  }, {\n    key: \"onRowLayoutChange\",\n    value: function onRowLayoutChange(ind, event) {\n      this.heights[ind] = event.nativeEvent.layout.height;\n    }\n  }, {\n    key: \"renderRow\",\n    value: function renderRow(_ref) {\n      var item = _ref.item,\n          index = _ref.index;\n      return React.createElement(View, {\n        onLayout: this.onRowLayoutChange.bind(this, index),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        }\n      }, React.createElement(Reservation, {\n        item: item,\n        renderItem: this.props.renderItem,\n        renderDay: this.props.renderDay,\n        renderEmptyDate: this.props.renderEmptyDate,\n        theme: this.props.theme,\n        rowHasChanged: this.props.rowHasChanged,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        }\n      }));\n    }\n  }, {\n    key: \"getReservationsForDay\",\n    value: function getReservationsForDay(iterator, props) {\n      var day = iterator.clone();\n      var res = props.reservations[day.toString('yyyy-MM-dd')];\n\n      if (res && res.length) {\n        return res.map(function (reservation, i) {\n          return {\n            reservation: reservation,\n            date: i ? false : day,\n            day: day\n          };\n        });\n      } else if (res) {\n        return [{\n          date: iterator.clone(),\n          day: day\n        }];\n      } else {\n        return false;\n      }\n    }\n  }, {\n    key: \"onListTouch\",\n    value: function onListTouch() {\n      this.scrollOver = true;\n    }\n  }, {\n    key: \"getReservations\",\n    value: function getReservations(props) {\n      if (!props.reservations || !props.selectedDay) {\n        return {\n          reservations: [],\n          scrollPosition: 0\n        };\n      }\n\n      var reservations = [];\n\n      if (this.state.reservations && this.state.reservations.length) {\n        var _iterator = this.state.reservations[0].day.clone();\n\n        while (_iterator.getTime() < props.selectedDay.getTime()) {\n          var res = this.getReservationsForDay(_iterator, props);\n\n          if (!res) {\n            reservations = [];\n            break;\n          } else {\n            reservations = reservations.concat(res);\n          }\n\n          _iterator.addDays(1);\n        }\n      }\n\n      var scrollPosition = reservations.length;\n      var iterator = props.selectedDay.clone();\n\n      for (var i = 0; i < 31; i++) {\n        var _res = this.getReservationsForDay(iterator, props);\n\n        if (_res) {\n          reservations = reservations.concat(_res);\n        }\n\n        iterator.addDays(1);\n      }\n\n      return {\n        reservations: reservations,\n        scrollPosition: scrollPosition\n      };\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      if (!this.props.reservations || !this.props.reservations[this.props.selectedDay.toString('yyyy-MM-dd')]) {\n        if (this.props.renderEmptyData) {\n          return this.props.renderEmptyData();\n        }\n\n        return React.createElement(ActivityIndicator, {\n          style: {\n            marginTop: 80\n          },\n          color: this.props.theme && this.props.theme.indicatorColor,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 194\n          }\n        });\n      }\n\n      return React.createElement(FlatList, {\n        ref: function ref(c) {\n          return _this3.list = c;\n        },\n        style: this.props.style,\n        contentContainerStyle: this.styles.content,\n        renderItem: this.renderRow.bind(this),\n        data: this.state.reservations,\n        onScroll: this.onScroll.bind(this),\n        showsVerticalScrollIndicator: false,\n        scrollEventThrottle: 200,\n        onMoveShouldSetResponderCapture: function onMoveShouldSetResponderCapture() {\n          _this3.onListTouch();\n\n          return false;\n        },\n        keyExtractor: function keyExtractor(item, index) {\n          return String(index);\n        },\n        refreshControl: this.props.refreshControl,\n        refreshing: this.props.refreshing || false,\n        onRefresh: this.props.onRefresh,\n        onScrollBeginDrag: this.props.onScrollBeginDrag,\n        onScrollEndDrag: this.props.onScrollEndDrag,\n        onMomentumScrollBegin: this.props.onMomentumScrollBegin,\n        onMomentumScrollEnd: this.props.onMomentumScrollEnd,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198\n        }\n      });\n    }\n  }]);\n\n  return ReservationList;\n}(Component);\n\nReservationList.displayName = 'IGNORE';\nReservationList.propTypes = {\n  rowHasChanged: PropTypes.func,\n  renderItem: PropTypes.func,\n  renderDay: PropTypes.func,\n  renderEmptyDate: PropTypes.func,\n  onDayChange: PropTypes.func,\n  onScroll: PropTypes.func,\n  reservations: PropTypes.object,\n  selectedDay: PropTypes.instanceOf(XDate),\n  topDay: PropTypes.instanceOf(XDate),\n  refreshControl: PropTypes.element,\n  refreshing: PropTypes.bool,\n  onRefresh: PropTypes.func,\n  onScrollBeginDrag: PropTypes.func,\n  onScrollEndDrag: PropTypes.func,\n  onMomentumScrollBegin: PropTypes.func,\n  onMomentumScrollEnd: PropTypes.func\n};\nexport default ReservationList;","map":{"version":3,"sources":["/home/harshit/Desktop/projects/ovuli/node_modules/react-native-calendars/src/agenda/reservation-list/index.js"],"names":["React","Component","Reservation","PropTypes","XDate","dateutils","styleConstructor","ReservationList","props","styles","theme","state","reservations","heights","selectedDay","scrollOver","updateDataSource","getReservations","setState","list","sameDate","scrollPosition","i","scrollToOffset","offset","animated","topDay","updateReservations","event","yOffset","nativeEvent","contentOffset","y","onScroll","topRowOffset","topRow","length","row","day","clone","onDayChange","ind","layout","height","item","index","onRowLayoutChange","bind","renderItem","renderDay","renderEmptyDate","rowHasChanged","iterator","res","toString","map","reservation","date","getTime","getReservationsForDay","concat","addDays","renderEmptyData","marginTop","indicatorColor","c","style","content","renderRow","onListTouch","String","refreshControl","refreshing","onRefresh","onScrollBeginDrag","onScrollEndDrag","onMomentumScrollBegin","onMomentumScrollEnd","displayName","propTypes","func","object","instanceOf","element","bool"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport {FlatList, ActivityIndicator, View} from 'react-native';\nimport Reservation from './reservation';\nimport PropTypes from 'prop-types';\nimport XDate from 'xdate';\n\nimport dateutils from '../../dateutils';\nimport styleConstructor from './style';\n\n\nclass ReservationList extends Component {\n  static displayName = 'IGNORE';\n  \n  static propTypes = {\n    // specify your item comparison function for increased performance\n    rowHasChanged: PropTypes.func,\n    // specify how each item should be rendered in agenda\n    renderItem: PropTypes.func,\n    // specify how each date should be rendered. day can be undefined if the item is not first in that day.\n    renderDay: PropTypes.func,\n    // specify how empty date content with no items should be rendered\n    renderEmptyDate: PropTypes.func,\n    // callback that gets called when day changes while scrolling agenda list\n    onDayChange: PropTypes.func,\n    // onScroll ListView event\n    onScroll: PropTypes.func,\n    // the list of items that have to be displayed in agenda. If you want to render item as empty date\n    // the value of date key kas to be an empty array []. If there exists no value for date key it is\n    // considered that the date in question is not yet loaded\n    reservations: PropTypes.object,\n    selectedDay: PropTypes.instanceOf(XDate),\n    topDay: PropTypes.instanceOf(XDate),\n    refreshControl: PropTypes.element,\n    refreshing: PropTypes.bool,\n    onRefresh: PropTypes.func,\n    onScrollBeginDrag: PropTypes.func,\n    onScrollEndDrag: PropTypes.func,\n    onMomentumScrollBegin: PropTypes.func,\n    onMomentumScrollEnd: PropTypes.func\n  };\n\n  constructor(props) {\n    super(props);\n    \n    this.styles = styleConstructor(props.theme);\n    \n    this.state = {\n      reservations: []\n    };\n    \n    this.heights=[];\n    this.selectedDay = this.props.selectedDay;\n    this.scrollOver = true;\n  }\n\n  UNSAFE_componentWillMount() {\n    this.updateDataSource(this.getReservations(this.props).reservations);\n  }\n\n  updateDataSource(reservations) {\n    this.setState({\n      reservations\n    });\n  }\n\n  updateReservations(props) {\n    const reservations = this.getReservations(props);\n    if (this.list && !dateutils.sameDate(props.selectedDay, this.selectedDay)) {\n      let scrollPosition = 0;\n      for (let i = 0; i < reservations.scrollPosition; i++) {\n        scrollPosition += this.heights[i] || 0;\n      }\n      this.scrollOver = false;\n      this.list.scrollToOffset({offset: scrollPosition, animated: true});\n    }\n    this.selectedDay = props.selectedDay;\n    this.updateDataSource(reservations.reservations);\n  }\n\n  UNSAFE_componentWillReceiveProps(props) {\n    if (!dateutils.sameDate(props.topDay, this.props.topDay)) {\n      this.setState({\n        reservations: []\n      }, () => {\n        this.updateReservations(props);\n      });\n    } else {\n      this.updateReservations(props);\n    }\n  }\n\n  onScroll(event) {\n    const yOffset = event.nativeEvent.contentOffset.y;\n    this.props.onScroll(yOffset);\n    let topRowOffset = 0;\n    let topRow;\n    for (topRow = 0; topRow < this.heights.length; topRow++) {\n      if (topRowOffset + this.heights[topRow] / 2 >= yOffset) {\n        break;\n      }\n      topRowOffset += this.heights[topRow];\n    }\n    const row = this.state.reservations[topRow];\n    if (!row) return;\n    const day = row.day;\n    const sameDate = dateutils.sameDate(day, this.selectedDay);\n    if (!sameDate && this.scrollOver) {\n      this.selectedDay = day.clone();\n      this.props.onDayChange(day.clone());\n    }\n  }\n\n  onRowLayoutChange(ind, event) {\n    this.heights[ind] = event.nativeEvent.layout.height;\n  }\n\n  renderRow({item, index}) {\n    return (\n      <View onLayout={this.onRowLayoutChange.bind(this, index)}>\n        <Reservation\n          item={item}\n          renderItem={this.props.renderItem}\n          renderDay={this.props.renderDay}\n          renderEmptyDate={this.props.renderEmptyDate}\n          theme={this.props.theme}\n          rowHasChanged={this.props.rowHasChanged}\n        />\n      </View>\n    );\n  }\n\n  getReservationsForDay(iterator, props) {\n    const day = iterator.clone();\n    const res = props.reservations[day.toString('yyyy-MM-dd')];\n    if (res && res.length) {\n      return res.map((reservation, i) => {\n        return {\n          reservation,\n          date: i ? false : day,\n          day\n        };\n      });\n    } else if (res) {\n      return [{\n        date: iterator.clone(),\n        day\n      }];\n    } else {\n      return false;\n    }\n  }\n\n  onListTouch() {\n    this.scrollOver = true;\n  }\n\n  getReservations(props) {\n    if (!props.reservations || !props.selectedDay) {\n      return {reservations: [], scrollPosition: 0};\n    }\n    let reservations = [];\n    if (this.state.reservations && this.state.reservations.length) {\n      const iterator = this.state.reservations[0].day.clone();\n      while (iterator.getTime() < props.selectedDay.getTime()) {\n        const res = this.getReservationsForDay(iterator, props);\n        if (!res) {\n          reservations = [];\n          break;\n        } else {\n          reservations = reservations.concat(res);\n        }\n        iterator.addDays(1);\n      }\n    }\n    const scrollPosition = reservations.length;\n    const iterator = props.selectedDay.clone();\n    for (let i = 0; i < 31; i++) {\n      const res = this.getReservationsForDay(iterator, props);\n      if (res) {\n        reservations = reservations.concat(res);\n      }\n      iterator.addDays(1);\n    }\n\n    return {reservations, scrollPosition};\n  }\n\n  render() {\n    if (!this.props.reservations || !this.props.reservations[this.props.selectedDay.toString('yyyy-MM-dd')]) {\n      if (this.props.renderEmptyData) {\n        return this.props.renderEmptyData();\n      }\n      return (\n        <ActivityIndicator style={{marginTop: 80}} color={this.props.theme && this.props.theme.indicatorColor}/>\n      );\n    }\n    return (\n      <FlatList\n        ref={(c) => this.list = c}\n        style={this.props.style}\n        contentContainerStyle={this.styles.content}\n        renderItem={this.renderRow.bind(this)}\n        data={this.state.reservations}\n        onScroll={this.onScroll.bind(this)}\n        showsVerticalScrollIndicator={false}\n        scrollEventThrottle={200}\n        onMoveShouldSetResponderCapture={() => {this.onListTouch(); return false;}}\n        keyExtractor={(item, index) => String(index)}\n        refreshControl={this.props.refreshControl}\n        refreshing={this.props.refreshing || false}\n        onRefresh={this.props.onRefresh}\n        onScrollBeginDrag={this.props.onScrollBeginDrag}\n        onScrollEndDrag={this.props.onScrollEndDrag}\n        onMomentumScrollBegin={this.props.onMomentumScrollBegin}\n        onMomentumScrollEnd={this.props.onMomentumScrollEnd}\n      />\n    );\n  }\n}\n\nexport default ReservationList;\n"]},"metadata":{},"sourceType":"module"}